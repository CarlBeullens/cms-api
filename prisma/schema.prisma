// ============================================
// PRISMA CONFIGURATION
// ============================================

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


// ============================================
// MODELS
// ============================================

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  files     File[]
  
  @@index([email])
}


model File {
  id           String     @id @default(uuid())
  filename     String
  originalName String
  mimeType     String
  size         Int
  storageKey   String     @unique
  status       FileStatus @default(UPLOADING)
  metadata     Json?
  
  userId       String
  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  
  @@index([userId])
  @@index([status])
  @@index([userId, createdAt])
}


enum FileStatus {
  UPLOADING
  PROCESSING
  READY
  FAILED
}
